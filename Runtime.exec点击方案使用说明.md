# 📱 HSR自动化助手 - Runtime.exec方案使用指南

## ✅ 当前方案

### 点击实现方式：`Runtime.exec("input tap x y")`

**优点**：
- ✅ 无需Root权限
- ✅ 无需无障碍服务
- ✅ 无需悬浮窗权限
- ✅ 纯Java API实现，100%兼容

**原理**：
```python
Runtime = autoclass('java.lang.Runtime')
runtime = Runtime.getRuntime()
cmd = f"input tap {x} {y}"
process = runtime.exec(cmd)
process.waitFor()
```

---

## 📋 使用步骤（超简单）

### 1. 安装APK
- 从GitHub Actions下载最新APK
- 在手机上安装

### 2. 允许存储权限
- 打开应用时会自动弹窗
- 点击"允许" ✅

### 3. 直接使用
- 点击"开始"按钮
- 应用会自动启动游戏并执行任务

**就这么简单！** 🎉

---

## 🔍 权限说明

### ✅ 必需权限（只有1个）
- **存储权限** (`READ_EXTERNAL_STORAGE`, `WRITE_EXTERNAL_STORAGE`)
  - 用途：读取templates文件夹中的模板图片

### ❌ 不需要的权限
- ~~悬浮窗权限~~ - 应用是全屏UI
- ~~无障碍服务~~ - 使用Runtime.exec替代
- ~~Root权限~~ - 完全不需要

---

## 📱 UI界面说明

### 主界面
```
┌─────────────────────────┐
│   HSR 自动化            │
│       助手              │
├─────────────────────────┤
│ > 状态: 就绪            │
│                         │
│ ☑ 每日委托              │
│                         │
│ [开始]     [停止]       │
│                         │
│ [权限]     [关于]       │
└─────────────────────────┘
```

### 权限页面
```
┌─────────────────────────┐
│      权限设置           │
├─────────────────────────┤
│ ✅ 存储权限             │
│ ✅ 点击功能(Runtime)    │
│                         │
│ 本应用使用Runtime.exec  │
│ 无需悬浮窗和无障碍服务  │
│                         │
│ 只需存储权限即可运行    │
│                         │
│ [🔄 刷新权限状态]       │
│                         │
│ [关闭]                  │
└─────────────────────────┘
```

---

## ⚠️ 可能的问题

### 问题1: 点击"开始"后显示"需要存储权限"
**解决方法**:
1. 进入手机"设置" → "应用管理"
2. 找到"HSR Automation"
3. 点击"权限"
4. 允许"存储"权限
5. 返回应用，再次点击"开始"

### 问题2: Runtime.exec("input tap")无法点击游戏
**原因**: Android安全限制，应用无法直接执行shell命令影响其他应用

**解决方案**:
#### 方案A: 开启ADB无线调试（推荐）
1. 在手机"设置" → "开发者选项"中开启"无线调试"
2. 手机和电脑连接同一WiFi
3. 在电脑执行: `adb connect 手机IP:端口`
4. 手机授权后，应用即可使用ADB权限执行点击

#### 方案B: Root设备（仅限高级用户）
1. Root手机（需自行研究，有风险）
2. 授予应用Root权限
3. 应用会自动使用`su -c input tap`执行点击

---

## 🎯 下一步优化方向

如果Runtime.exec方案确实无法点击游戏，我们有以下备选方案：

1. **ADB授权方案**（最可行）
   - 用户开启无线调试
   - 应用通过ADB权限执行点击
   - 无需Root

2. **Python AccessibilityService**
   - 用Kivy Service运行Python版无障碍服务
   - 不需要编译Java
   - 需要用户手动开启服务

3. **Root方案**（最后选择）
   - 要求用户Root手机
   - 使用`su -c`执行命令
   - 100%可以点击

---

## 📝 当前版本特性

✅ 已实现：
- Runtime.exec点击功能
- 只需存储权限
- 简化的UI和权限管理
- 自动启动游戏
- 中文字体支持

❓ 待测试：
- Runtime.exec是否能点击其他应用（游戏）
- 如不能，需切换到备选方案

---

## 🚀 提交命令

```powershell
git add .
git commit -m "简化权限管理，只需存储权限，移除无用的无障碍服务按钮"
git push
```

测试后如果Runtime.exec无法点击游戏，请告诉我，我会立即切换到**ADB方案**或**Python AccessibilityService方案**！

